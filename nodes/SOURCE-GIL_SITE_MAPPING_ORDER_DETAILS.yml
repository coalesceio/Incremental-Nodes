fileVersion: 1
id: c4c33297-b3e2-44ff-ad89-bc31465d1e5e
name: GIL_SITE_MAPPING_ORDER_DETAILS
operation:
  config:
    batchLoad: false
    batchSize: 0
    incColumn:
      columnCounter: b810629d-d137-4ab8-839f-1266e720acd6
      stepCounter: c4c33297-b3e2-44ff-ad89-bc31465d1e5e
    joinKeyColumnName: SITEID
    mappingID: "1000"
    persistColumnName: SITEID
    persistTableLocation: TARGET
    persistTableName: PSTG_SITE1
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: SOURCE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27acd997-4533-4bce-a2ec-a6414c9fd1af
          stepCounter: c4c33297-b3e2-44ff-ad89-bc31465d1e5e
        config: {}
        dataType: VARCHAR(2)
        description: ""
        name: SITE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67565321-5ddf-4f8f-a7c3-9374852f2e14
                stepCounter: 2ae80d32-f0fe-42f6-a33a-f2f445a31484
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc6a0035-d458-4a53-a342-3e25de0a1c08
          stepCounter: c4c33297-b3e2-44ff-ad89-bc31465d1e5e
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: SITEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8a787a4-3a41-40d7-8e16-f22d77440f3b
                stepCounter: 2ae80d32-f0fe-42f6-a33a-f2f445a31484
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d2a52a4-b99e-4739-8b8d-6c9f4bb4b62b
          stepCounter: c4c33297-b3e2-44ff-ad89-bc31465d1e5e
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: L_ORDERKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a0637427-3a5f-4c0c-a9a9-016ec9978171
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa0f7417-beeb-41f8-881a-70a2930076f5
          stepCounter: c4c33297-b3e2-44ff-ad89-bc31465d1e5e
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: L_SUPPKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb780f78-7d24-4e5e-9b17-c7c6e276307e
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8838e2aa-017f-462a-9b66-6fb0cfde7bd0
          stepCounter: c4c33297-b3e2-44ff-ad89-bc31465d1e5e
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: L_LINENUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b98ed73-5cdb-4c35-833a-ab243ffb39ca
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d404456-e5ad-4460-bae9-7932845f13d3
          stepCounter: c4c33297-b3e2-44ff-ad89-bc31465d1e5e
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: L_QUANTITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce644a05-68b3-4809-b8e8-2f5ad4cd24a3
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29314e2a-b884-45c7-8a21-a7a4e7bb9968
          stepCounter: c4c33297-b3e2-44ff-ad89-bc31465d1e5e
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: L_EXTENDEDPRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b79b6693-2274-499f-b29c-6290c4a80fd4
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4fc0c7d6-5db2-40c9-89ec-4afa25427a74
          stepCounter: c4c33297-b3e2-44ff-ad89-bc31465d1e5e
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: L_DISCOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bbbfb538-1d6f-496a-b4ca-8f24871b3d65
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: "10"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0933c4d2-0109-4a07-ad90-ecbee357fe51
          stepCounter: c4c33297-b3e2-44ff-ad89-bc31465d1e5e
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: L_TAX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 644b09d9-876c-4e94-985f-66005f8005ab
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d8731b5-f9e0-4303-8fe9-d5305cffe27d
          stepCounter: c4c33297-b3e2-44ff-ad89-bc31465d1e5e
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: L_RETURNFLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 681dbc18-c0fd-4f26-b435-79d80672576d
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71a940dc-c29c-48e8-bc31-fba8e418a600
          stepCounter: c4c33297-b3e2-44ff-ad89-bc31465d1e5e
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: L_LINESTATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c13b29fc-fbd8-4b88-a326-46d40fe46830
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50366e0d-2712-4dfd-a266-20b30ce1c738
          stepCounter: c4c33297-b3e2-44ff-ad89-bc31465d1e5e
        config: {}
        dataType: DATE
        description: ""
        name: L_SHIPDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4cbd079f-8aa1-4750-8c0f-f514014b1a0e
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cbc2a8ef-70c6-4832-ad4e-509617eb3fbe
          stepCounter: c4c33297-b3e2-44ff-ad89-bc31465d1e5e
        config: {}
        dataType: DATE
        description: ""
        name: L_COMMITDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01a9d573-aab9-4333-8807-e4f153f1f465
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: afe7cec3-0339-4783-aa44-66f807748d33
          stepCounter: c4c33297-b3e2-44ff-ad89-bc31465d1e5e
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: L_SHIPINSTRUCT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23a6ab19-b518-4c7f-befb-f47e457cf52c
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f974275-6a65-4036-9e6e-690ce4305af6
          stepCounter: c4c33297-b3e2-44ff-ad89-bc31465d1e5e
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: L_SHIPMODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d6341267-24b4-48d9-a743-47937601959a
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9806ce1-9818-4de2-8dba-0c3efc9ebf67
          stepCounter: c4c33297-b3e2-44ff-ad89-bc31465d1e5e
        config: {}
        dataType: VARCHAR(44)
        description: ""
        name: L_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c643143-a035-4c71-84ae-a0e244ed1e87
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b810629d-d137-4ab8-839f-1266e720acd6
          stepCounter: c4c33297-b3e2-44ff-ad89-bc31465d1e5e
        config: {}
        dataType: TIMESTAMP_LTZ(9)
        description: ""
        name: L_LOAD_TIMESTAMP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3da25604-fdfb-40b9-b6db-4bcab3055285
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ORDER_DETAILS: 069a1a62-acb9-4041-8d35-b20415c2059f
          SITE_MAPPING: 2ae80d32-f0fe-42f6-a33a-f2f445a31484
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: ORDER_DETAILS
          - locationName: TARGET
            nodeName: SITE_MAPPING
        join:
          joinCondition: |-
            FROM{{ ref('TARGET', 'ORDER_DETAILS') }} "ORDER_DETAILS"
              INNER JOIN{{ ref('TARGET', 'SITE_MAPPING') }} "SITE_MAPPING"
              ON SITE_MAPPING.SITEID = <SITEID>
                WHERE "ORDER_DETAILS"."L_LOAD_TIMESTAMP" > 
              (SELECT COALESCE(MAX("L_LOAD_TIMESTAMP"), '1900-01-01') 
              FROM {{ ref_no_link('TARGET', 'PSTG_SITE1') }}
              WHERE SITEID  = <SITEID>)
        name: GIL_SITE_MAPPING_ORDER_DETAILS
        noLinkRefs:
          - locationName: TARGET
            nodeName: PSTG_SITE1
  name: GIL_SITE_MAPPING_ORDER_DETAILS
  overrideSQL: false
  schema: ""
  sqlType: "394"
  type: sql
  version: 1
type: Node
