fileVersion: 1
id: f0a892ca-55a6-4cf6-8b87-1715d343877e
name: LC_ANIMAL
operation:
  config:
    batchLoad: false
    batchSize: null
    batchValue: null
    incColumn:
      columnCounter: 577fb27a-c90f-45c2-b9d0-e62accb5cad5
      stepCounter: f0a892ca-55a6-4cf6-8b87-1715d343877e
    mappingID: "1000"
    persistColumnName: SITEID
    persistTableLocation: TARGET
    persistTableName: PSTG_SITE1
    postSQL: ""
    preSQL: ""
    refTable: true
    siteId: 1000,2000
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: SOURCE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9791426e-887c-4199-8ec0-748fcbe63ac2
          stepCounter: f0a892ca-55a6-4cf6-8b87-1715d343877e
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: L_ORDERKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4d52ef0-88b7-424b-81e5-54dacea54a46
                stepCounter: 8c20731d-de7d-4ee2-940b-74412cc577f8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf7e677a-0c47-450e-95ec-725455e6d1d0
          stepCounter: f0a892ca-55a6-4cf6-8b87-1715d343877e
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: L_SUPPKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f34c1c4-4c42-40e6-8ca9-04e40d79963d
                stepCounter: 8c20731d-de7d-4ee2-940b-74412cc577f8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e79d60f4-5e00-4e55-975c-026284063038
          stepCounter: f0a892ca-55a6-4cf6-8b87-1715d343877e
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: L_LINENUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ba25514-8533-407d-b023-7716ad02ee92
                stepCounter: 8c20731d-de7d-4ee2-940b-74412cc577f8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6854a1ea-5033-4fab-98c1-d53c46ebdb6c
          stepCounter: f0a892ca-55a6-4cf6-8b87-1715d343877e
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: L_QUANTITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ae60328-bc13-4096-80de-cb1476e108b4
                stepCounter: 8c20731d-de7d-4ee2-940b-74412cc577f8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29639d0a-ab99-4b3a-abbf-3c05599bacc5
          stepCounter: f0a892ca-55a6-4cf6-8b87-1715d343877e
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: L_EXTENDEDPRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 25724f69-6600-43a3-8a1b-d043ae73fc30
                stepCounter: 8c20731d-de7d-4ee2-940b-74412cc577f8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67959bcf-3440-42f6-bbaa-a6326bd38fa1
          stepCounter: f0a892ca-55a6-4cf6-8b87-1715d343877e
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: L_DISCOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6bda0f4c-3288-417d-8508-175765472231
                stepCounter: 8c20731d-de7d-4ee2-940b-74412cc577f8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16fe1b32-4e8d-4fb8-9ad2-a45c774d6182
          stepCounter: f0a892ca-55a6-4cf6-8b87-1715d343877e
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: L_TAX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f380a381-490d-44ce-a604-5954a03657f2
                stepCounter: 8c20731d-de7d-4ee2-940b-74412cc577f8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2509c487-b36d-4278-a24e-58a40b5c981a
          stepCounter: f0a892ca-55a6-4cf6-8b87-1715d343877e
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: L_RETURNFLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe0874d5-94ba-4cbc-b22d-e70eb109e4a9
                stepCounter: 8c20731d-de7d-4ee2-940b-74412cc577f8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7dbd8d8-3f66-4ce3-9ec6-c8c319690103
          stepCounter: f0a892ca-55a6-4cf6-8b87-1715d343877e
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: L_LINESTATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bea451c9-41b0-48df-a888-645c7cdfc00b
                stepCounter: 8c20731d-de7d-4ee2-940b-74412cc577f8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 12ec5090-23d5-4b18-b55d-2c9ffd4a0a42
          stepCounter: f0a892ca-55a6-4cf6-8b87-1715d343877e
        config: {}
        dataType: DATE
        description: ""
        name: L_SHIPDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 26bc65fb-2e81-40f4-a79e-004221b62e7f
                stepCounter: 8c20731d-de7d-4ee2-940b-74412cc577f8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69316497-0169-416c-8799-82994488b33d
          stepCounter: f0a892ca-55a6-4cf6-8b87-1715d343877e
        config: {}
        dataType: DATE
        description: ""
        name: L_COMMITDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c27b227-5393-48ba-a3b3-846b3e73d593
                stepCounter: 8c20731d-de7d-4ee2-940b-74412cc577f8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ef4d071-8c3c-4f73-9aef-37fbe5d2d76f
          stepCounter: f0a892ca-55a6-4cf6-8b87-1715d343877e
        config: {}
        dataType: DATE
        description: ""
        name: L_RECEIPTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a334ee55-3ac1-439d-b253-0237949df370
                stepCounter: 8c20731d-de7d-4ee2-940b-74412cc577f8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98f4cfb6-d107-4619-84fd-a818c90d52de
          stepCounter: f0a892ca-55a6-4cf6-8b87-1715d343877e
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: L_SHIPINSTRUCT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8828fc2-0448-44e7-b385-38fed60edbe7
                stepCounter: 8c20731d-de7d-4ee2-940b-74412cc577f8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1983aa67-738b-4f05-ab4f-85bacad6b65a
          stepCounter: f0a892ca-55a6-4cf6-8b87-1715d343877e
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: L_SHIPMODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05419d0f-5b7c-4be1-9ffa-c36645e9e42b
                stepCounter: 8c20731d-de7d-4ee2-940b-74412cc577f8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3cb5234-0aa7-4040-a6d3-8362740da322
          stepCounter: f0a892ca-55a6-4cf6-8b87-1715d343877e
        config: {}
        dataType: VARCHAR(44)
        description: ""
        name: L_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e3c9f072-3113-49aa-9b33-8f842980afc1
                stepCounter: 8c20731d-de7d-4ee2-940b-74412cc577f8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 577fb27a-c90f-45c2-b9d0-e62accb5cad5
          stepCounter: f0a892ca-55a6-4cf6-8b87-1715d343877e
        config: {}
        dataType: TIMESTAMP_LTZ(9)
        description: ""
        name: L_LOAD_TIMESTAMP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 638f62b0-01de-4b18-8421-e3fb5b19daf2
                stepCounter: 8c20731d-de7d-4ee2-940b-74412cc577f8
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ANIMAL: 8c20731d-de7d-4ee2-940b-74412cc577f8
          SITE_MAPPING: 2ae80d32-f0fe-42f6-a33a-f2f445a31484
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: ANIMAL
          - locationName: TARGET
            nodeName: SITE_MAPPING
        join:
          joinCondition: |
            FROM{{ ref('TARGET', 'ANIMAL') }} "ANIMAL"
              INNER JOIN{{ ref('TARGET', 'SITE_MAPPING') }} "SITE_MAPPING"
              ON <SITEID> = "SITE_MAPPING"."SITEID"
              WHERE "ANIMAL"."L_LOAD_TIMESTAMP" > 
              (SELECT COALESCE(MAX("L_LOAD_TIMESTAMP"), '1900-01-01') 
              FROM {{ ref_no_link('TARGET', 'PSTG_SITE1') }}
              WHERE "SITEID" = <SITEID>)
        name: LC_ANIMAL
        noLinkRefs:
          - locationName: TARGET
            nodeName: PSTG_SITE1
  name: LC_ANIMAL
  overrideSQL: false
  schema: ""
  sqlType: "394"
  type: sql
  version: 1
type: Node
