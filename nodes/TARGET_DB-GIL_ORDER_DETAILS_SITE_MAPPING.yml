fileVersion: 1
id: 0cf2fc22-f97a-4249-a722-950793341166
name: GIL_ORDER_DETAILS_SITE_MAPPING
operation:
  config:
    batchLoad: true
    batchSize: "2"
    incColumn:
      columnCounter: 1f911c65-f711-436d-87d7-ee00b9ac9e77
      stepCounter: 0cf2fc22-f97a-4249-a722-950793341166
    joinKeyColumnName: SITEID
    mappingID: 1000,2000,3000,4000,TARGET
    persistColumnName: SITEID
    persistTableLocation: TARGET
    persistTableName: PSTG_ORDER_DETAILS_SITE_MAPPING
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET_DB
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6b3ba90-d91a-4581-a08a-5cad2c714717
          stepCounter: 0cf2fc22-f97a-4249-a722-950793341166
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: L_ORDERKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a0637427-3a5f-4c0c-a9a9-016ec9978171
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c40251e-7cc7-4e1b-aa06-b56fe2c8d6dc
          stepCounter: 0cf2fc22-f97a-4249-a722-950793341166
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: L_SUPPKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb780f78-7d24-4e5e-9b17-c7c6e276307e
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9bb16ab5-7ff0-4f69-9661-4036cb3dd0eb
          stepCounter: 0cf2fc22-f97a-4249-a722-950793341166
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: L_LINENUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b98ed73-5cdb-4c35-833a-ab243ffb39ca
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f70b9d9c-05d7-42b1-957d-91f05c47790b
          stepCounter: 0cf2fc22-f97a-4249-a722-950793341166
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: L_QUANTITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce644a05-68b3-4809-b8e8-2f5ad4cd24a3
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a11f315e-5a78-4ed8-8d7c-b5d055e8ace6
          stepCounter: 0cf2fc22-f97a-4249-a722-950793341166
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: L_EXTENDEDPRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b79b6693-2274-499f-b29c-6290c4a80fd4
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c2db096-0381-4d0e-9d89-af4b8b2a75a5
          stepCounter: 0cf2fc22-f97a-4249-a722-950793341166
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: L_DISCOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bbbfb538-1d6f-496a-b4ca-8f24871b3d65
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f7097b3-d4eb-4266-9219-621f4c913575
          stepCounter: 0cf2fc22-f97a-4249-a722-950793341166
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: L_TAX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 644b09d9-876c-4e94-985f-66005f8005ab
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31dfce50-d9b7-49d4-9ceb-539c60928e84
          stepCounter: 0cf2fc22-f97a-4249-a722-950793341166
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: L_RETURNFLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 681dbc18-c0fd-4f26-b435-79d80672576d
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f282200-9ea8-468a-8a27-30a1cc687522
          stepCounter: 0cf2fc22-f97a-4249-a722-950793341166
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: L_LINESTATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c13b29fc-fbd8-4b88-a326-46d40fe46830
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 58f72109-fe6f-4873-bc95-ec4dc079f0c3
          stepCounter: 0cf2fc22-f97a-4249-a722-950793341166
        config: {}
        dataType: DATE
        description: ""
        name: L_SHIPDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4cbd079f-8aa1-4750-8c0f-f514014b1a0e
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5615de99-b1fb-4824-b399-04689f8e9ad4
          stepCounter: 0cf2fc22-f97a-4249-a722-950793341166
        config: {}
        dataType: DATE
        description: ""
        name: L_COMMITDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01a9d573-aab9-4333-8807-e4f153f1f465
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31cb6129-f438-4a6d-beca-73f3ea883016
          stepCounter: 0cf2fc22-f97a-4249-a722-950793341166
        config: {}
        dataType: DATE
        description: ""
        name: L_RECEIPTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95f6872f-95f9-47ad-af87-be85010383de
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5d80598-8637-4a49-8d4b-885f046b7c0b
          stepCounter: 0cf2fc22-f97a-4249-a722-950793341166
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: L_SHIPINSTRUCT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23a6ab19-b518-4c7f-befb-f47e457cf52c
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4422dbda-0aef-4741-afa0-107a4f153447
          stepCounter: 0cf2fc22-f97a-4249-a722-950793341166
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: L_SHIPMODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d6341267-24b4-48d9-a743-47937601959a
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b57b60b8-564c-471a-8bd1-02d43dca5952
          stepCounter: 0cf2fc22-f97a-4249-a722-950793341166
        config: {}
        dataType: VARCHAR(44)
        description: ""
        name: L_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c643143-a035-4c71-84ae-a0e244ed1e87
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f911c65-f711-436d-87d7-ee00b9ac9e77
          stepCounter: 0cf2fc22-f97a-4249-a722-950793341166
        config: {}
        dataType: TIMESTAMP_LTZ(9)
        description: ""
        name: L_LOAD_TIMESTAMP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3da25604-fdfb-40b9-b6db-4bcab3055285
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01da2745-0c9b-4dde-90ec-a92aa7cbadf4
          stepCounter: 0cf2fc22-f97a-4249-a722-950793341166
        config: {}
        dataType: VARCHAR(2)
        description: ""
        name: SITE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67565321-5ddf-4f8f-a7c3-9374852f2e14
                stepCounter: 2ae80d32-f0fe-42f6-a33a-f2f445a31484
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2cadff1-7f18-4821-bf08-59be3dfbea91
          stepCounter: 0cf2fc22-f97a-4249-a722-950793341166
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: SITEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8a787a4-3a41-40d7-8e16-f22d77440f3b
                stepCounter: 2ae80d32-f0fe-42f6-a33a-f2f445a31484
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET_DB
            nodeName: ORDER_DETAILS
          - locationName: TARGET_DB
            nodeName: SITE_MAPPING
        join:
          joinCondition: |-
            FROM{{ ref('TARGET_DB', 'ORDER_DETAILS') }} "ORDER_DETAILS"
              INNER JOIN{{ ref('TARGET_DB', 'SITE_MAPPING') }} "SITE_MAPPING"
              ON SITE_MAPPING.SITEID = <SITEID>
                WHERE "ORDER_DETAILS"."L_LOAD_TIMESTAMP" > 
              (SELECT COALESCE(MAX("L_LOAD_TIMESTAMP"), '1900-01-01') 
              FROM {{ ref_no_link('TARGET_DB', 'PSTG_ORDER_DETAILS_SITE_MAPPING') }}
              WHERE SITEID  = <SITEID>)
        name: GIL_ORDER_DETAILS_SITE_MAPPING
        noLinkRefs:
          - locationName: TARGET_DB
            nodeName: PSTG_ORDER_DETAILS_SITE_MAPPING
  name: GIL_ORDER_DETAILS_SITE_MAPPING
  overrideSQL: false
  schema: ""
  sqlType: "394"
  type: sql
  version: 1
type: Node
