fileVersion: 1
id: 064cca8b-4512-4718-b0e4-6d4e24b79533
name: GR_CUSTOMER_ACCOUNTS
operation:
  config:
    foccurrence: true
    loccurence: false
    timcol:
      columnCounter: 7cc18c0a-c649-4baa-9dc2-4be8f0c32292
      stepCounter: 064cca8b-4512-4718-b0e4-6d4e24b79533
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET_DB
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f1f299b8-4c00-4153-bab8-d2e9c08f3996
          stepCounter: 064cca8b-4512-4718-b0e4-6d4e24b79533
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: ACCOUNT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59451c4c-70d1-4026-bb6f-60c04775a77a
                stepCounter: 391d9870-9d85-44ae-825d-bd41f9d83b83
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29b0f905-7068-403b-8967-2eb943bd5847
          stepCounter: 064cca8b-4512-4718-b0e4-6d4e24b79533
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: CUSTOMER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d4c8a08-dbae-4407-a541-783a09963dd0
                stepCounter: 391d9870-9d85-44ae-825d-bd41f9d83b83
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e46e2eb5-e703-4d24-b5ea-db29cea17f5e
          stepCounter: 064cca8b-4512-4718-b0e4-6d4e24b79533
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52e7760a-52d0-40bb-8876-8ecd1a0bac5a
                stepCounter: 391d9870-9d85-44ae-825d-bd41f9d83b83
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7cc18c0a-c649-4baa-9dc2-4be8f0c32292
          stepCounter: 064cca8b-4512-4718-b0e4-6d4e24b79533
        config: {}
        dataType: DATE
        description: ""
        name: SIGNUP_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e1bf8cb-0e92-47ed-a4b3-c84a9e080d14
                stepCounter: 391d9870-9d85-44ae-825d-bd41f9d83b83
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c85d0787-6fa0-4f97-a2ac-de821486fc24
          stepCounter: 064cca8b-4512-4718-b0e4-6d4e24b79533
        config: {}
        dataType: NUMBER(1,0)
        description: ""
        name: ACCOUNT_ID_null
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0240728c-066a-4884-bf70-fdad93ffd4c4
                stepCounter: 391d9870-9d85-44ae-825d-bd41f9d83b83
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7331f561-44f5-4332-a767-2af80431d0e9
          stepCounter: 064cca8b-4512-4718-b0e4-6d4e24b79533
        config: {}
        dataType: NUMBER(1,0)
        description: ""
        name: ACCOUNT_ID_dup
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 529c8b8f-526f-4a4d-9312-2ca675f1d639
                stepCounter: 391d9870-9d85-44ae-825d-bd41f9d83b83
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7288ef43-e26e-4443-9c1b-922fbfb00692
          stepCounter: 064cca8b-4512-4718-b0e4-6d4e24b79533
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: QUALITY_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab102005-12f5-4f98-ac6a-23ad4eda2757
                stepCounter: 391d9870-9d85-44ae-825d-bd41f9d83b83
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 240ce85c-708e-4ad8-a27a-74c5c7bdc22b
          stepCounter: 064cca8b-4512-4718-b0e4-6d4e24b79533
        config: {}
        dataType: NUMBER(1,0)
        description: ""
        name: CUSTOMER_NAME_null
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6858244c-b9ec-441e-90d4-74cdbe41fbd7
                stepCounter: 391d9870-9d85-44ae-825d-bd41f9d83b83
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5261654e-1ade-40ae-80e0-c5b450851e80
          stepCounter: 064cca8b-4512-4718-b0e4-6d4e24b79533
        config: {}
        dataType: NUMBER(3,0)
        description: ""
        name: TOTAL_FAILED_TESTS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6b82b37c-7bd4-4591-a4eb-dd310d39fd02
                stepCounter: 391d9870-9d85-44ae-825d-bd41f9d83b83
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          INC_CUSTOMER_ACCOUNTS: 391d9870-9d85-44ae-825d-bd41f9d83b83
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET_DB
            nodeName: INC_CUSTOMER_ACCOUNTS
        join:
          joinCondition: |
            FROM {{ ref('TARGET_DB', 'INC_CUSTOMER_ACCOUNTS') }} "INC_CUSTOMER_ACCOUNTS"QUALIFY QUALITY_FLAG = 'G' OR ROW_NUMBER() OVER (PARTITION BY ACCOUNT_ID ORDER BY SIGNUP_DATE ASC) = 1 AND  "ACCOUNT_ID_null" < 1 AND "CUSTOMER_NAME_null" < 1
        name: GR_CUSTOMER_ACCOUNTS
        noLinkRefs: []
  name: GR_CUSTOMER_ACCOUNTS
  overrideSQL: false
  schema: ""
  sqlType: "622"
  type: sql
  version: 1
type: Node
