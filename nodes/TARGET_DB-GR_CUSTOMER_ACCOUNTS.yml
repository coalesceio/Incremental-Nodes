fileVersion: 1
id: 58364cb8-281c-4c6d-bbff-e86898dd79eb
name: GR_CUSTOMER_ACCOUNTS
operation:
  config:
    foccurrence: true
    loccurence: false
    timcol:
      columnCounter: 48cabd99-034c-410f-a8ad-538a5f0872ee
      stepCounter: 58364cb8-281c-4c6d-bbff-e86898dd79eb
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET_DB
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c57d0ad-5c05-43f8-b80c-42e0916cd13d
          stepCounter: 58364cb8-281c-4c6d-bbff-e86898dd79eb
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: ACCOUNT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 995f1376-54aa-47f8-bd04-48760561ce7b
                stepCounter: ebb94b33-2e3e-4400-ad7a-3402d94e0982
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02faba6f-45bf-4a10-87ab-7074a6e49b7b
          stepCounter: 58364cb8-281c-4c6d-bbff-e86898dd79eb
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: CUSTOMER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ccf8767-beab-4462-b776-5a80a0fdf5b3
                stepCounter: ebb94b33-2e3e-4400-ad7a-3402d94e0982
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29491e41-4c30-476d-ba8b-04e738baf066
          stepCounter: 58364cb8-281c-4c6d-bbff-e86898dd79eb
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 416ff730-61f4-4626-a04f-9ba4847750f6
                stepCounter: ebb94b33-2e3e-4400-ad7a-3402d94e0982
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48cabd99-034c-410f-a8ad-538a5f0872ee
          stepCounter: 58364cb8-281c-4c6d-bbff-e86898dd79eb
        config: {}
        dataType: DATE
        description: ""
        name: SIGNUP_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 80ce5aac-4543-4792-a651-63d5a3dddd77
                stepCounter: ebb94b33-2e3e-4400-ad7a-3402d94e0982
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c26e936-5e1f-4224-9d17-b2cc1b550913
          stepCounter: 58364cb8-281c-4c6d-bbff-e86898dd79eb
        config: {}
        dataType: NUMBER(1,0)
        description: ""
        name: ACCOUNT_ID_null
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb34ba71-07c0-4151-af25-f30965c03d3e
                stepCounter: ebb94b33-2e3e-4400-ad7a-3402d94e0982
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 00d05cb0-0990-47b7-8723-41485323cc0c
          stepCounter: 58364cb8-281c-4c6d-bbff-e86898dd79eb
        config: {}
        dataType: NUMBER(1,0)
        description: ""
        name: ACCOUNT_ID_dup
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a455f81d-4d34-46c8-814b-67934f6fe2c4
                stepCounter: ebb94b33-2e3e-4400-ad7a-3402d94e0982
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c4e197a-c34f-4e56-9f1b-79d00a611a42
          stepCounter: 58364cb8-281c-4c6d-bbff-e86898dd79eb
        config: {}
        dataType: NUMBER(2,0)
        description: ""
        name: TOTAL_FAILED_TESTS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0109e648-7534-4957-82f6-479f3fea719e
                stepCounter: ebb94b33-2e3e-4400-ad7a-3402d94e0982
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7daf91a9-6fce-4571-8df8-93f628d2b708
          stepCounter: 58364cb8-281c-4c6d-bbff-e86898dd79eb
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: QUALITY_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1cae69cd-b196-4725-b269-58453fd1b87b
                stepCounter: ebb94b33-2e3e-4400-ad7a-3402d94e0982
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          INC_CUSTOMER_ACCOUNTS: ebb94b33-2e3e-4400-ad7a-3402d94e0982
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET_DB
            nodeName: INC_CUSTOMER_ACCOUNTS
        join:
          joinCondition: |-
            FROM {{ ref('TARGET_DB', 'INC_CUSTOMER_ACCOUNTS') }} "INC_CUSTOMER_ACCOUNTS"
              QUALIFY QUALITY_FLAG = 'G' OR ROW_NUMBER() OVER (PARTITION BY ACCOUNT_ID ORDER BY SIGNUP_DATE ASC) = 1 AND  "ACCOUNT_ID_null" < 1
        name: GR_CUSTOMER_ACCOUNTS
        noLinkRefs: []
  name: GR_CUSTOMER_ACCOUNTS
  overrideSQL: false
  schema: ""
  sqlType: "622"
  type: sql
  version: 1
type: Node
