fileVersion: 1
id: 9578a7dd-baee-4e37-a2b0-b28cf14170ec
name: GIL_ORDER_DETAILS_SITE_MAPPING
operation:
  config:
    batchLoad: true
    batchSize: "3"
    incColumn:
      columnCounter: 29d341d7-8404-46e2-8d8c-bed105e1e091
      stepCounter: 9578a7dd-baee-4e37-a2b0-b28cf14170ec
    joinKeyColumnName: SITEID
    mappingID: 1000,2000,3000,4000,TARGET
    persistColumnName: SITEID
    persistTableLocation: TARGET
    persistTableName: PSTG_SITE1
  database: ""
  deployEnabled: true
  description: This is grouped incremental load table
  isMultisource: false
  locationName: SOURCE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46cc4a70-7abb-4d56-b3b3-3cf99908b093
          stepCounter: 9578a7dd-baee-4e37-a2b0-b28cf14170ec
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: L_ORDERKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a0637427-3a5f-4c0c-a9a9-016ec9978171
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 707f8229-1a68-4e56-af7c-bca99f02a044
          stepCounter: 9578a7dd-baee-4e37-a2b0-b28cf14170ec
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: L_SUPPKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb780f78-7d24-4e5e-9b17-c7c6e276307e
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4264e1a-541f-414d-adc9-4686c1d7c603
          stepCounter: 9578a7dd-baee-4e37-a2b0-b28cf14170ec
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: L_LINENUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b98ed73-5cdb-4c35-833a-ab243ffb39ca
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9dc684e6-035b-4c9b-b4b5-bb650ffaa750
          stepCounter: 9578a7dd-baee-4e37-a2b0-b28cf14170ec
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: L_QUANTITY_NEW
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce644a05-68b3-4809-b8e8-2f5ad4cd24a3
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 540db1c8-24c1-4760-a42e-598e66fc15ea
          stepCounter: 9578a7dd-baee-4e37-a2b0-b28cf14170ec
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: L_EXTENDEDPRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b79b6693-2274-499f-b29c-6290c4a80fd4
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8e83a63-983d-4e67-9cb8-bb6126b05566
          stepCounter: 9578a7dd-baee-4e37-a2b0-b28cf14170ec
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: L_DISCOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bbbfb538-1d6f-496a-b4ca-8f24871b3d65
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 985f09bc-0b48-48c6-bd8c-734b16e809b2
          stepCounter: 9578a7dd-baee-4e37-a2b0-b28cf14170ec
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: L_TAX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 644b09d9-876c-4e94-985f-66005f8005ab
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 00fe29ce-881f-4c36-9f1d-7e345112cd9b
          stepCounter: 9578a7dd-baee-4e37-a2b0-b28cf14170ec
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: L_RETURNFLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 681dbc18-c0fd-4f26-b435-79d80672576d
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a05c9c0-7336-4345-95f1-da6259534afd
          stepCounter: 9578a7dd-baee-4e37-a2b0-b28cf14170ec
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: L_LINESTATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c13b29fc-fbd8-4b88-a326-46d40fe46830
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b37bba63-140a-433c-a18a-5cc2a7f00af6
          stepCounter: 9578a7dd-baee-4e37-a2b0-b28cf14170ec
        config: {}
        dataType: DATE
        description: ""
        name: L_SHIPDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4cbd079f-8aa1-4750-8c0f-f514014b1a0e
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d4f5b98-c382-41ea-89f7-4d5679862674
          stepCounter: 9578a7dd-baee-4e37-a2b0-b28cf14170ec
        config: {}
        dataType: DATE
        description: ""
        name: L_COMMITDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01a9d573-aab9-4333-8807-e4f153f1f465
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29ba6240-c422-427e-8e2d-524fd82c8808
          stepCounter: 9578a7dd-baee-4e37-a2b0-b28cf14170ec
        config: {}
        dataType: DATE
        description: ""
        name: L_RECEIPTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95f6872f-95f9-47ad-af87-be85010383de
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d26ca33-673f-4354-981e-3d8043374c71
          stepCounter: 9578a7dd-baee-4e37-a2b0-b28cf14170ec
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: L_SHIPINSTRUCT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23a6ab19-b518-4c7f-befb-f47e457cf52c
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04a862d1-3226-4db5-a298-807d923d4175
          stepCounter: 9578a7dd-baee-4e37-a2b0-b28cf14170ec
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: L_SHIPMODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d6341267-24b4-48d9-a743-47937601959a
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3009d0a1-d4d9-46c8-acae-c6e1fa33f021
          stepCounter: 9578a7dd-baee-4e37-a2b0-b28cf14170ec
        config: {}
        dataType: VARCHAR(44)
        description: ""
        name: L_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c643143-a035-4c71-84ae-a0e244ed1e87
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29d341d7-8404-46e2-8d8c-bed105e1e091
          stepCounter: 9578a7dd-baee-4e37-a2b0-b28cf14170ec
        config: {}
        dataType: TIMESTAMP_LTZ(9)
        description: ""
        name: L_LOAD_TIMESTAMP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3da25604-fdfb-40b9-b6db-4bcab3055285
                stepCounter: 069a1a62-acb9-4041-8d35-b20415c2059f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bcaf2baf-f7e9-4b42-997b-0486fac69699
          stepCounter: 9578a7dd-baee-4e37-a2b0-b28cf14170ec
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: SITEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8a787a4-3a41-40d7-8e16-f22d77440f3b
                stepCounter: 2ae80d32-f0fe-42f6-a33a-f2f445a31484
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70bb04b9-8c02-4d14-8761-af4715134c66
          stepCounter: 9578a7dd-baee-4e37-a2b0-b28cf14170ec
        config: {}
        dataType: VARCHAR(2)
        description: ""
        name: SITE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67565321-5ddf-4f8f-a7c3-9374852f2e14
                stepCounter: 2ae80d32-f0fe-42f6-a33a-f2f445a31484
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ORDER_DETAILS: 069a1a62-acb9-4041-8d35-b20415c2059f
          SITE_MAPPING: 2ae80d32-f0fe-42f6-a33a-f2f445a31484
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: ORDER_DETAILS
          - locationName: TARGET
            nodeName: SITE_MAPPING
        join:
          joinCondition: |-
            FROM{{ ref('TARGET', 'ORDER_DETAILS') }} "ORDER_DETAILS"
              INNER JOIN{{ ref('TARGET', 'SITE_MAPPING') }} "SITE_MAPPING"
              ON SITE_MAPPING.SITEID = <SITEID>
                WHERE "ORDER_DETAILS"."L_LOAD_TIMESTAMP" > 
              (SELECT COALESCE(MAX("L_LOAD_TIMESTAMP"), '1900-01-01') 
              FROM {{ ref_no_link('TARGET', 'PSTG_SITE1') }}
              WHERE SITEID  = <SITEID>)
        name: GIL_ORDER_DETAILS_SITE_MAPPING
        noLinkRefs:
          - locationName: TARGET
            nodeName: PSTG_SITE1
  name: GIL_ORDER_DETAILS_SITE_MAPPING
  overrideSQL: false
  schema: ""
  sqlType: "394"
  type: sql
  version: 1
type: Node
